2025-03-01 10:19:27,810 - __main__ - INFO - Starting phishing detection model training...
2025-03-01 10:19:27,811 - __main__ - INFO - Loading datasets...
2025-03-01 10:19:27,882 - __main__ - INFO - Training data: 51097 samples
2025-03-01 10:19:27,882 - __main__ - INFO - Validation data: 10950 samples
2025-03-01 10:19:27,883 - __main__ - INFO - Extracting features from URLs...
2025-03-01 10:19:42,840 - __main__ - INFO - Extracted 136 features
2025-03-01 10:19:42,845 - __main__ - INFO - Feature extractor saved to models/url_extractor.pkl
2025-03-01 10:19:42,845 - __main__ - INFO - Training Random Forest model...
2025-03-01 10:20:36,393 - __main__ - INFO - Best parameters: {'max_depth': 20, 'min_samples_leaf': 1, 'min_samples_split': 5, 'n_estimators': 200}
2025-03-01 10:20:36,464 - __main__ - INFO - Training time: 53.55 seconds
2025-03-01 10:20:36,464 - __main__ - INFO - Validation metrics - Accuracy: 0.9975, Precision: 1.0000, Recall: 0.9971, F1: 0.9986
2025-03-01 10:20:36,470 - __main__ - INFO - 
Classification Report:
              precision    recall  f1-score   support

           0       0.98      1.00      0.99      1500
           1       1.00      1.00      1.00      9450

    accuracy                           1.00     10950
   macro avg       0.99      1.00      0.99     10950
weighted avg       1.00      1.00      1.00     10950

2025-03-01 10:20:36,523 - __main__ - INFO - Random Forest model saved to models/rf_model.pkl
2025-03-01 10:20:36,562 - __main__ - INFO - 
Top 10 important features:
2025-03-01 10:20:36,563 - __main__ - INFO -               feature  importance
7         num_slashes    0.105802
21        path_length    0.079423
86           ngram_50    0.062379
115          ngram_79    0.058404
127          ngram_91    0.055991
107          ngram_71    0.054433
108          ngram_72    0.049740
0          url_length    0.041060
133          ngram_97    0.040976
2    subdomain_length    0.035746
2025-03-01 10:20:36,570 - __main__ - INFO - Training Gradient Boosting model...
2025-03-01 10:24:21,434 - __main__ - INFO - Best parameters: {'learning_rate': 0.1, 'max_depth': 3, 'min_samples_split': 2, 'n_estimators': 200}
2025-03-01 10:24:21,481 - __main__ - INFO - Training time: 224.86 seconds
2025-03-01 10:24:21,481 - __main__ - INFO - Validation metrics - Accuracy: 0.9976, Precision: 1.0000, Recall: 0.9972, F1: 0.9986
2025-03-01 10:24:21,488 - __main__ - INFO - 
Classification Report:
              precision    recall  f1-score   support

           0       0.98      1.00      0.99      1500
           1       1.00      1.00      1.00      9450

    accuracy                           1.00     10950
   macro avg       0.99      1.00      1.00     10950
weighted avg       1.00      1.00      1.00     10950

2025-03-01 10:24:21,497 - __main__ - INFO - Gradient Boosting model saved to models/gb_model.pkl
2025-03-01 10:24:21,497 - __main__ - INFO - Comparing models and selecting the best one...
2025-03-01 10:24:21,600 - __main__ - INFO - Random Forest F1: 0.9986
2025-03-01 10:24:21,601 - __main__ - INFO - Gradient Boosting F1: 0.9986
2025-03-01 10:24:21,601 - __main__ - INFO - Best model: Gradient Boosting
2025-03-01 10:24:21,616 - __main__ - INFO - Best model saved as models/production_model.pkl
2025-03-01 10:24:21,619 - __main__ - INFO - Model training completed successfully.
